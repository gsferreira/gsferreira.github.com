<!doctype html><html lang="en" class="font-normal font-sans leading-relaxed antialiased"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#ffffff"><base href="/archive/2015/06/create-an-api-in-azure-app-service-revista-programar-n49/"><meta name="description" content="Guilherme Ferreira - Minimalist developer"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="google" content="nositelinkssearchbox"><meta name="generator" content="eleventy"><meta name="format-detection" content="telephone=no"><link rel="canonical" href="https://gsferreira.com/archive/2015/06/create-an-api-in-azure-app-service-revista-programar-n49/"><title>Create an API in Azure App Service - Revista PROGRAMAR N¬∫ 49 Guilherme Ferreira - Minimalist developer</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="manifest" href="/images/site.webmanifest"><meta property="og:url" content="https://gsferreira.com/archive/2015/06/create-an-api-in-azure-app-service-revista-programar-n49/"><meta property="og:type" content="website"><meta property="og:title" content="Create an API in Azure App Service - Revista PROGRAMAR N¬∫ 49"><meta property="og:image" content="https://gsferreira.com/images/logo.jpg"><meta property="og:description" content="Guilherme Ferreira - Minimalist developer"><meta property="og:site_name" content="Guilherme Ferreira - Minimalist developer"><meta property="og:locale" content="en_GB"><meta property="article:author" content="Guilherme Ferreira"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@gsferreira"><meta name="twitter:creator" content="@gsferreira"><meta name="twitter:description" content="Software Architect | @netponto Team | Father &amp; Husband üë®‚Äçüë©‚Äçüëß | Black Lab Companion üê∂ | Ankylosing Spondylitis üíä | Minimalism üå± | Continuous improvement"><meta name="twitter:image" content="https://gsferreira.com/images/logo.jpg"><meta name="twitter:title" content="Guilherme Ferreira"><meta name="twitter:dnt" content="on"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-33436813-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-33436813-1")</script><style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}a{background-color:transparent}strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}small{font-size:80%}img{border-style:none}button,input,select{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}figure,h1,h2,h3,h4,p{margin:0}button{background-color:transparent;background-image:none;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}ul{list-style:none;margin:0;padding:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#d2d6dc}img{border-style:solid}input::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder{color:#a0aec0}input::-ms-input-placeholder{color:#a0aec0}input::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,select{padding:0;line-height:inherit;color:inherit}code{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}:root{--measure:48rem;--flow-space:1.5em;--color-bodybg:#ffffff;--color-bodytext:#364152;--color-muted:#f9fafb;--color-primary:#047481;--color-secondary:#0694a2;--color-links:var(--color-primary);--color-focus:var(--color-secondary);--form-shadow:0 2px 15px 0 rgba(210, 214, 220, 0.5)}.dark-mode{--color-bodybg:#1a202e;--color-bodytext:#e2e8f0;--color-muted:#27303f;--color-primary:#16bdca;--color-secondary:#7edce2;--form-shadow:0 2px 15px 0 rgba(26, 26, 27, 0.637)}:root{-webkit-overflow-scrolling:touch;scroll-behavior:smooth;text-rendering:optimizeSpeed}::selection{color:#fff;background-color:var(--color-primary)}button:focus{outline:1px solid var(--color-focus);outline-offset:.1rem}section{padding-left:1.5rem;padding-right:1.5rem;padding-top:4rem;padding-bottom:4rem}h1,h2,h3,h4{font-weight:700;line-height:1.25;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}h1{font-size:3rem}h2{font-size:2.25rem}h3{font-size:1.875rem}h4{font-size:1.5rem}@media (min-width:768px){h1{font-size:4rem}h2{font-size:3rem}h3{font-size:2.25rem}h4{font-size:1.875rem}}a:not([class]){-webkit-text-decoration-line:underline;text-decoration-line:underline;-webkit-text-decoration-skip:ink;text-decoration-skip-ink:auto;-webkit-text-decoration-color:var(--color-links);text-decoration-color:var(--color-links);text-decoration-thickness:2px;text-underline-offset:3px}a:not([class]):hover{color:var(--color-links)}.flow{max-width:var(--measure)}.flow>*+*{margin-top:1.5em;margin-top:var(--flow-space)}.flow>p+p{--flow-space:1em}.flow>h1+p,.flow>h2+p,.flow>h3+p,.flow>h4+p{--flow-space:1.25em}.measure{max-width:var(--measure)}.markdown ul{list-style-type:disc;list-style-position:inside}.container{width:100%;margin-right:auto;margin-left:auto}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.focus\:not-sr-only:focus{position:static;width:auto;height:auto;padding:0;margin:0;overflow:visible;clip:auto;white-space:normal}.bg-gray-500{background-color:#6b7280}.bg-bodybg{background-color:var(--color-bodybg)}.bg-muted{background-color:var(--color-muted)}.bg-primary{background-color:var(--color-primary)}.hover\:bg-secondary:hover{background-color:var(--color-secondary)}.focus\:bg-primary:focus{background-color:var(--color-primary)}.border-transparent{border-color:transparent}.border-cool-gray-100{border-color:#f1f5f9}.border-primary{border-color:var(--color-primary)}.hover\:border-cool-gray-700:hover{border-color:#364152}.focus\:border-cool-gray-700:focus{border-color:#364152}.dark-mode .dark\:border-gray-700{border-color:#374151}.dark-mode .dark\:border-cool-gray-800{border-color:#27303f}.rounded-full{border-radius:9999px}.border{border-width:1px}.border-b-2{border-bottom-width:2px}.border-t{border-top-width:1px}.border-b{border-bottom-width:1px}.cursor-not-allowed{cursor:not-allowed}.block{display:block}.flex{display:flex}.grid{display:grid}.table{display:table}.hidden{display:none}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.flex-grow{flex-grow:1}.font-sans{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}.font-light{font-weight:300}.font-normal{font-weight:400}.font-semibold{font-weight:600}.font-bold{font-weight:700}.font-black{font-weight:900}.h-6{height:1.5rem}.h-12{height:3rem}.leading-5{line-height:1.25rem}.leading-relaxed{line-height:1.625}.mx-4{margin-left:1rem;margin-right:1rem}.my-auto{margin-top:auto;margin-bottom:auto}.mx-auto{margin-left:auto;margin-right:auto}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mb-2{margin-bottom:.5rem}.mt-6{margin-top:1.5rem}.ml-6{margin-left:1.5rem}.mt-8{margin-top:2rem}.mt-10{margin-top:2.5rem}.mt-16{margin-top:4rem}.mt-20{margin-top:5rem}.mb-20{margin-bottom:5rem}.ml-auto{margin-left:auto}.-mb-px{margin-bottom:-1px}.min-h-screen{min-height:100vh}.opacity-50{opacity:.5}.focus\:outline-none:focus{outline:0}.overflow-hidden{overflow:hidden}.overflow-x-hidden{overflow-x:hidden}.p-2{padding:.5rem}.p-6{padding:1.5rem}.px-1{padding-left:.25rem;padding-right:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.static{position:static}.absolute{position:absolute}.relative{position:relative}.sticky{position:-webkit-sticky;position:sticky}.top-0{top:0}.text-center{text-align:center}.text-white{color:#fff}.text-gray-500{color:#6b7280}.text-gray-600{color:#4b5563}.text-bodytext{color:var(--color-bodytext)}.text-primary{color:var(--color-primary)}.hover\:text-secondary:hover{color:var(--color-secondary)}.focus\:text-white:focus{color:#fff}.dark-mode .dark\:text-cool-gray-900{color:#1a202e}.text-sm{font-size:.875rem}.text-base{font-size:1rem}.text-lg{font-size:1.125rem}.text-2xl{font-size:1.5rem}.uppercase{text-transform:uppercase}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.tracking-wider{letter-spacing:.05em}.visible{visibility:visible}.invisible{visibility:hidden}.whitespace-no-wrap{white-space:nowrap}.w-6{width:1.5rem}.w-12{width:3rem}.z-10{z-index:10}.transform{--transform-translate-x:0;--transform-translate-y:0;--transform-rotate:0;--transform-skew-x:0;--transform-skew-y:0;--transform-scale-x:1;--transform-scale-y:1;transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y))}.fade-in-down{-webkit-animation:fadeInDown .7s ease both;animation:fadeInDown .7s ease both}@keyframes fadeInDown{0%{opacity:0;transform:translateY(-20px)}100%{opacity:1;transform:translateY(0)}}.sun-icon{display:none}.dark-mode .sun-icon{display:block}.dark-mode .moon-icon{display:none}a[rel~=external]::after{content:"‚Üó";font-family:system-ui,-apple-system,sans-serif;font-style:normal;font-weight:900;color:currentColor;padding-left:.2em;line-height:.75;-webkit-text-decoration-line:none;text-decoration-line:none}@media (min-width:640px){.sm\:visible{visibility:visible}}@media (min-width:768px){.md\:ml-12{margin-left:3rem}.md\:text-xl{font-size:1.25rem}}</style></head><body class="bg-bodybg text-bodytext text-lg md:text-xl overflow-x-hidden flex flex-col min-h-screen"><a class="text-center sr-only focus:not-sr-only focus:outline-none focus:bg-primary focus:text-white" href="#main-content">Skip to content</a><div class="sticky top-0 z-10 bg-bodybg text-bodytext border-b border-cool-gray-100 dark:border-cool-gray-800 px-4 tracking-wider"><nav class="flex items-center mx-auto measure"><a href="/" class="p-2"><img src="/images/logo.jpg" alt="Guilherme Ferreira" class="rounded-full h-12 w-12 flex items-center justify-center invisible sm:visible"> <span class="sr-only">Go back to homepage</span></a><div class="flex items-center ml-auto -mb-px"><a href="/" class="px-1 py-6 leading-5 whitespace-no-wrap border-b-2 border-transparent focus:outline-none hover:border-cool-gray-700 focus:border-cool-gray-700 ml-6 md:ml-12">Home</a> <a href="/blog/" class="px-1 py-6 leading-5 whitespace-no-wrap border-b-2 border-transparent focus:outline-none hover:border-cool-gray-700 focus:border-cool-gray-700 ml-6 md:ml-12">Blog</a> <a href="/about/" class="px-1 py-6 leading-5 whitespace-no-wrap border-b-2 border-transparent focus:outline-none hover:border-cool-gray-700 focus:border-cool-gray-700 ml-6 md:ml-12">About</a> <button id="dark-mode-toggle" class="p-2 ml-6 md:ml-12"><svg aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" class="w-6 h-6 moon-icon"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg> <svg aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" class="w-6 h-6 sun-icon"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg> <span class="sr-only">Button to switch between dark and light theme</span></button></div></nav></div><main id="main-content" style="scroll-margin-top:5rem" class="flex flex-col flex-grow"><section><article class="mx-auto measure markdown"><time value="Thu Jun 18 2015 00:00:00 GMT+0000 (Coordinated Universal Time)" class="text-sm text-gray-600">Last updated: 18 June 2015</time><h1 class="mt-6">Create an API in Azure App Service - Revista PROGRAMAR N¬∫ 49</h1><div class="mt-6 text-2xl text-gray-500 flow"></div><div class="mt-8 flow"><p><em>I had the pleasure of write an <a href="http://www.revista-programar.info/artigos/criar-uma-api-no-azure-app-sevice/">article</a> to the <a href="http://www.revista-programar.info/anuncios/revista-programar-no-49-junho-2015/">Revista PROGRAMAR</a>, a Portuguese collaborative magazine about programming. I‚Äôm glad with my first article for a magazine and especially because, I'm side by side with people that I admire like <a href="https://twitter.com/PauloMorgado">Paulo Morgado</a> or <a href="https://twitter.com/saramgsilva">Sara Silva</a>, for instance. This was an amazing experience and I want to share with you the result of it.</em></p><h2>Introduction</h2><p>In March, Microsoft announced an improvement in his services by introducing the new Azure App Service. This service covers the ‚Äúoldest‚Äù Websites, now named as Web Apps, the Azure Mobile Services, now, Mobile Apps, and introduce new capabilities as Logic Apps and the API Apps. This article talks about the last one. The question is: What‚Äôs the reason to create an API App, and not a Web API in a Website? This question can be easily answered, analysing the feature list, for example:</p><ul><li>Access Control using Azure Active Directory or OAuth services, as Facebook or Twitter;</li><li>Fast integration with the Swagger Framework;</li><li>Easy integration with Logic Apps;</li><li>Private gallery of APIs, enabling us to provide APIs to the other members of the organization;</li><li>Automatic generation of an SDK for our API.</li></ul><p>In this article we will see, how to create an API, publish in our subscription and create an SDK to consume it.</p><h2>Description</h2><p>There are many services, inside the organizations, that are necessary to multiple applications. A good example of that is the send email notifications. Let imagine that we pretend to provide an API, so that all applications of our organization, can easily send emails, without need to know the logic of using the email server. Before we start, we need to be sure that <a href="http://go.microsoft.com/fwlink/?linkid=324322&amp;clcid=0x409">Microsoft Azure SDK for .NET 2.6</a> is installed.</p><h3>Create an API App project</h3><p>Let‚Äôs start to see how to create a project for our API App.</p><ol><li>Open Visual Studio 2013;</li><li>Create a new project using <strong>File &gt; New Project</strong>;</li><li>Choose the template <strong>ASP.NET Web Application</strong>;</li><li>Give a name to the project, in this case we will use MailApi;</li></ol><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-1.png" alt="New Project"></p><ol start="5"><li>Click <strong>OK</strong>;</li><li>Select the template <strong>Azure API App</strong>;</li></ol><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-2.png" alt="Template"></p><ol start="7"><li>Click <strong>OK</strong> and to create the project.</li></ol><h3>Create the service to send emails</h3><p>Let‚Äôs see how to expose a method for sending emails in our API. For that, we will create a class that represents the data model to receive the request, and a controller to provide the sending method.</p><ol><li>In the folder Models, add a new class with the name MailModel. Mouse right click in the folder Models, and select the option <strong>Add &gt; Class</strong>.</li><li>In the created file, MailModel.cs, add the following code:</li></ol><pre class="language-csharp"><code class="language-csharp">   <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>DataAnnotations</span><span class="token punctuation">;</span><br>   <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MailModel</span><br>   <span class="token punctuation">{</span><br>      <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Required</span></span><span class="token punctuation">]</span><br>      <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EmailAddress</span></span><span class="token punctuation">]</span><br>      <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> To <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><br><br>      <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Required</span></span><span class="token punctuation">]</span><br>      <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Subject <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><br><br>      <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Required</span></span><span class="token punctuation">]</span><br>      <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Body <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><br>   <span class="token punctuation">}</span></code></pre><ol start="3"><li>Add a controller to the project (controllers file) with the name MailController, using the template, <strong>Web API 2 Controller ‚Äì Empty</strong>.</li></ol><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-3.png" alt="Scaffold"></p><ol start="4"><li>In the created file, <strong>MailController.cs</strong>, add the following method:</li></ol><pre class="language-csharp"><code class="language-csharp">   <span class="token keyword">using</span> <span class="token namespace">MailApi<span class="token punctuation">.</span>Models</span><span class="token punctuation">;</span><br>   <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpPost</span></span><span class="token punctuation">]</span><br>   <span class="token keyword">public</span> <span class="token return-type class-name">HttpResponseMessage</span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FromBody</span></span><span class="token punctuation">]</span><span class="token class-name">MailModel</span> data<span class="token punctuation">)</span><br>   <span class="token punctuation">{</span><br>      <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mail<span class="token punctuation">.</span>SmtpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>      <span class="token punctuation">{</span><br>        <span class="token comment">// create the message</span><br>        <span class="token class-name"><span class="token keyword">var</span></span> mailFrom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mail<span class="token punctuation">.</span>MailAddress</span><span class="token punctuation">(</span><span class="token string">"noreply@deathstar.com"</span><span class="token punctuation">,</span> <span class="token string">"Death Star"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token class-name"><span class="token keyword">var</span></span> mailTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mail<span class="token punctuation">.</span>MailAddress</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>To<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token class-name"><span class="token keyword">var</span></span> mail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mail<span class="token punctuation">.</span>MailMessage</span><span class="token punctuation">(</span>mailFrom<span class="token punctuation">,</span> mailTo<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        mail<span class="token punctuation">.</span>Subject <span class="token operator">=</span> data<span class="token punctuation">.</span>Subject<span class="token punctuation">;</span><br>        mail<span class="token punctuation">.</span>Body <span class="token operator">=</span> data<span class="token punctuation">.</span>Body<span class="token punctuation">;</span><br>        mail<span class="token punctuation">.</span>IsBodyHtml <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br><br>        <span class="token comment">// send email</span><br>        client<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>mail<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>      <span class="token keyword">return</span> Request<span class="token punctuation">.</span><span class="token function">CreateResponse</span><span class="token punctuation">(</span>HttpStatusCode<span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span><br>   <span class="token punctuation">}</span></code></pre><h3>Configure the service</h3><p>Since in this example we will send the e-mail via SMTP, we will need to configure the e-mail server data.</p><ol><li>Access the <strong>Web.config</strong> file of our application;</li><li>Add the following configuration (before the line):</li></ol><pre class="language-xml"><code class="language-xml">       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>system.net</span><span class="token punctuation">></span></span><br>         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mailSettings</span><span class="token punctuation">></span></span><br>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>smtp</span> <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>noreply@deathstar.com<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>network</span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mail.deathstar.com<span class="token punctuation">"</span></span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>587<span class="token punctuation">"</span></span> <span class="token attr-name">userName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>noreply@deathstar.com<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#MayTheForceBeWithThisPassword!<span class="token punctuation">"</span></span> <span class="token attr-name">enableSsl</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>smtp</span><span class="token punctuation">></span></span><br>         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mailSettings</span><span class="token punctuation">></span></span><br>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>system.net</span><span class="token punctuation">></span></span></code></pre><ol start="3"><li>Fill in with the data from our server.</li></ol><h3>Publish the application to the Azure App Service</h3><p>The publication can be made to an App Service, previously created using the portal, but in the next step we will see how to create the same without leaving Visual Studio.</p><p>To do this, it‚Äôs required to have an Azure subscription. If you don‚Äôt have it, you can create one test subscription of a month, in http://azure.microsoft.com/en-us/pricing/free-trial/. If you already have it, follow the next steps:</p><ol><li>In Solution Explorer, right click in project and click <strong>Publish</strong>;</li><li>In the publish dialog, access the <strong>Profile</strong> panel and choose the option <strong>Microsoft Azure API Apps</strong>;</li></ol><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-4.png" alt="Publish"></p><ol start="3"><li>Click <strong>New</strong> to create a new API App in the subscription;</li></ol><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-5.png" alt="Azure API Apps"></p><ol start="4"><li>In the Create dialog, add:</li></ol><ul><li>The API App name. Here we will use <strong>MailApiService</strong>;</li><li>Select the disired subscription;</li><li>Pick a name to the App Service;</li><li>Pick a name to the Resource Group;</li><li>Choose the access level Available to Anyone;</li><li>Pick the region where you what to host the App Service.</li></ul><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-6.png" alt="Create API App dialog"></p><ol start="5"><li>Click <strong>OK</strong> and wait a few minutes while the service is being created. The creation request can be followed in the Azure App Service Activity panel;</li><li>Once the App Service is created, we go back to the step number 1, access the publish dialog, and we click in the <strong>Publish</strong> option;</li></ol><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-7.png" alt="Publish"></p><ol start="7"><li>The service will be published.</li></ol><h3>Consume na API from a .NET client.</h3><p>Let‚Äôs see how to create an SDK to our API and use it.</p><ol><li>Add a Console Application to our solution;</li></ol><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-8.png" alt="Add console app"></p><ol start="2"><li>In the Solution Explorer, right click in the Console Application and select the option <strong>Add &gt; Azure API App Client</strong>;</li><li>In the presented dialog, pick the option <strong>Download from Microsoft Azure API App</strong> and select the MailApiService, create previously;</li></ol><p><img src="/images/create-an-api-in-azure-app-service-revista-programar-n49-7.png" alt="Add Azure API App Client"></p><ol start="4"><li>Click <strong>OK</strong> and wait until the SDK is created;</li><li>When the last step is completed, we are ready to invoke our API, as the following code shows.</li></ol><pre class="language-csharp"><code class="language-csharp">  <span class="token keyword">class</span> <span class="token class-name">Program</span><br>  <span class="token punctuation">{</span><br>    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span><br>    <span class="token punctuation">{</span><br>      <span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MailApiService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token class-name"><span class="token keyword">var</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Models<span class="token punctuation">.</span>MailModel</span> <span class="token punctuation">{</span> To <span class="token operator">=</span> <span class="token string">"darth.vader@deathstar.com"</span><span class="token punctuation">,</span> Subject <span class="token operator">=</span> <span class="token string">"War Report"</span><span class="token punctuation">,</span> Body <span class="token operator">=</span> <span class="token string">"The Force awakens"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>      <span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span>Mail<span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>      Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Done!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span></code></pre><h2>Summary</h2><p>With this new service created by Microsoft, we are able to provide features that in the past had a huge development cost, in an easy and quick way. The private gallery in conjunction with the easy way to consume APIs, provides the required capabilities to create an API ecosystem.</p></div><nav class="mx-auto mt-16 measure"><a href="/blog/">‚Üê Blog index</a></nav><div class="flex flex-row justify-center mt-20"><script async="async" data-uid="6b1314a04e" src="https://gsferreira.ck.page/6b1314a04e/index.js"></script></div><div id="disqus_thread"></div><script>var disqus_config=function(){this.page.url="https://gsferreira.com/archive/2015/06/create-an-api-in-azure-app-service-revista-programar-n49/"};!function(){var e=document,a=e.createElement("script");a.src="https://gsferreira.disqus.com/embed.js",a.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(a)}()</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></article></section></main><footer class="border-t border-cool-gray-100 dark:border-gray-700 bg-muted"><div class="p-6 mx-auto overflow-hidden text-base measure"><div class="flex flex-wrap justify-center mt-2"><div class="px-8"><a rel="external" href="https://twitter.com/gsferreira">Twitter</a></div><div class="px-8"><a rel="external" href="https://github.com/gsferreira">GitHub</a></div><div class="px-8"><a href="/feed.xml">RSS</a></div></div><div class="mt-6 mb-2"><p class="text-center text-gray-500">&copy; Guilherme Ferreira</p><p class="text-center text-gray-500">POWERED BY <a href="https://www.11ty.dev/" title="11TY">11TY</a></p></div></div></footer><script>let darkMode=localStorage.getItem("darkMode");const darkModeToggle=document.querySelector("#dark-mode-toggle"),enableDarkMode=()=>{document.querySelector("html").classList.add("dark-mode"),localStorage.setItem("darkMode","enabled")},disableDarkMode=()=>{document.querySelector("html").classList.remove("dark-mode"),localStorage.setItem("darkMode",null)};"enabled"===darkMode&&enableDarkMode(),darkModeToggle.addEventListener("click",()=>{darkMode=localStorage.getItem("darkMode"),"enabled"!==darkMode?enableDarkMode():(document.querySelector("html").classList.remove("dark-mode"),localStorage.setItem("darkMode",null))});</script></body></html>